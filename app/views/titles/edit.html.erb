<h1>Editing title</h1>

<%= nested_form_for @title,:html=>{:class=>"form-horizontal"} do |f| %>
<% if @title.errors.any? %>
    <div id="error_explanation">
      <h2><%= pluralize(@title.errors.count, "error") %> prohibited this title from being saved:</h2>
      
      <ul>
	<% @title.errors.full_messages.each do |msg| %>
        <li><%= msg %></li>
	<% end %>
      </ul>
    </div>
    <% end %>
    
  <div class="field control-group">
    <%= f.label :title, :class=>"control-label" %>
    <div class="controls">
      <%= f.text_field :title %>
    </div>
  </div>

  <div class="field control-group">
    <%= f.label :contributors, :class=>"control-label" %><br />
    <div class="controls">
      <%= f.fields_for :contributions do |contribution_form| %>
      <%= contribution_form.autocomplete_field :author, autocomplete_author_full_name_contributions_path,:id_element => "#author-#{contribution_form.my_unique_id}", :name=>'ignorethisonsubmit' %>
      <%= contribution_form.hidden_field :author_id, :id => "author-#{contribution_form.my_unique_id}" %>
      <%= contribution_form.text_field :what,:placeholder=>"Type of contribution" %>
      <%= contribution_form.link_to_remove raw("<i class='icon-minus'></i> Remove this contributor"), :class=>"btn" %>
      <% end %>
      <div class="verticaloffset">
	<%= f.link_to_add raw("<i class='icon-plus'></i> Add a contributor"), :contributions, {:class=>:btn} %>
	<%= link_to raw("<i class='icon-plus'></i> Create a new author"), new_author_path, {:class=>:btn,:target=>:new} %>
      </div>
    </div>
  </div>

  <div class="field control-group">
    <%= f.label :editions, :class=>"control-label" %><br />
    <div class="controls">
      <%= f.fields_for :editions do |edition_form| %>
      <%= edition_form.text_field :isbn13,:placeholder=>"ISBN-13" %>
      <%= edition_form.text_field :isbn10,:placeholder=>"ISBN-10" %>
      <%= edition_form.select :format, ['Hardcover','Paperback'] %>
      <%= edition_form.link_to_remove raw("<i class='icon-minus'></i> Remove this edition"), :class=>"btn" %>
      <% end %>
      <div class="verticaloffset">
	<%= f.link_to_add raw("<i class='icon-plus'></i> Add an edition"), :editions, {:class=>:btn} %>
      </div>
    </div>
  </div>




  <div class="actions control-group">
    <div class="controls">
    <%= f.submit :value=>"Save",:class=>"btn btn-large btn-primary" %>
    </div>
  </div>
<% end %>


<%= link_to 'Show', @title %> |
<%= link_to 'Back', titles_path %>

